extend layout

block content

  script(type='text/javascript').
      var defImage =!{JSON.stringify(defImage)}
    
  .mainblock

    script(type='text/javascript', src="http://code.jquery.com/jquery-1.9.1.min.js")
    script(type='text/javascript', src="tvmapping/js/easeljs-0.6.1.min.js")
    script(type='text/javascript', src="tvmapping/js/qlib_min.js")
    script(type='text/javascript', src="tvmapping/js/tvmapping.js")
    script.

      $('document').ready(function() {

        $('#testButton').click(function() {
          submitSkew();
        })

        init();
        currentImage = document.createElement("img"); 
        currentImage.src = 'out/thetimeofthegame/' + defImage.localURL;
        currentImage.onload = processImage;        

      })

      function submitSkew() {
        var out = [[corners_in[0].x, corners_in[0].y],[corners_in[1].x, corners_in[1].y],[corners_in[2].x, corners_in[2].y],[corners_in[3].x, corners_in[3].y]];

        $.get( "http://timeofthegame.o-c-r.org/report/" + defImage.id + "/" + out.toString(), function( data ) {
          //alert( "Load was performed." + data );
        });

        console.log(out);
      }


  div.canvii
    | <canvas id="imageHolder" width="800" height="800" style="position:absolute;z-index:0;top:30;left:0;"></canvas>
    | <canvas id="output" width="800" height="800" style="position:absolute;z-index:1;top:30;left:800px;"></canvas>
    | <canvas id="uiCanvas" width="1600" height="800" style="position:absolute;z-index:2;top:30;left:0;"></canvas>


  .footer
    | <div id="testButton">
    |   Click here
    | </div>
